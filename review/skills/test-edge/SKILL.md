# Test Edge — 엣지케이스 테스트 생성

analyze 스킬에서 도출된 엣지케이스 또는 사용자가 직접 설명한 엣지케이스에 대한 테스트 코드를 생성합니다.

**입력:** `$ARGUMENTS` — `[--from-analyze] [엣지케이스 설명]`

---

## 인자 파싱 규칙

| 인자 | 필수 | 기본값 | 설명 |
|------|------|--------|------|
| `--from-analyze` | - | - | 직전 analyze 결과의 엣지케이스를 자동으로 사용 |
| 텍스트 | - | - | 엣지케이스를 직접 설명 |

> `--from-analyze`와 텍스트를 동시에 사용하면, analyze 결과의 엣지케이스 + 사용자 추가 엣지케이스를 모두 포함합니다.
> 둘 다 없으면 사용자에게 엣지케이스 입력을 요청합니다.

---

## 동작 지침

### Step 1: 엣지케이스 수집

#### `--from-analyze` 지정 시

- 같은 세션에서 실행된 직전 `/review:analyze` 결과를 참조합니다
- 분석 리포트의 **엣지케이스 (Edge Cases)** 섹션에서 시나리오 목록을 추출합니다
- 각 엣지케이스의 시나리오, 현재 처리 상태, 위험도를 파악합니다

#### 텍스트 입력 시

- 사용자가 제공한 텍스트를 파싱하여 개별 엣지케이스 목록으로 정리합니다
- 각 엣지케이스에 대해 구체적 시나리오를 명확히 정의합니다

#### 둘 다 없는 경우

- 사용자에게 테스트할 엣지케이스를 입력해달라고 요청합니다
- 예시를 함께 보여줍니다:
  ```
  테스트할 엣지케이스를 설명해주세요. 예:
  - 빈 입력값이 들어올 때
  - 동시에 여러 요청이 들어올 때
  - 네트워크 타임아웃이 발생할 때
  ```

### Step 2: 기존 테스트 탐색

**Task(Explore) 에이전트**를 사용하여 다음을 파악합니다:

- 변경 대상 파일의 기존 테스트 파일 탐색
  - 패턴: `*.test.*`, `*.spec.*`, `test_*`, `*_test.*`, `__tests__/`
- 테스트 프레임워크 자동 감지
  - `package.json` → Jest, Vitest, Mocha 등
  - `pyproject.toml` / `setup.cfg` → pytest, unittest 등
  - `Cargo.toml` → Rust 내장 테스트
  - `go.mod` → Go 내장 테스트
- 기존 테스트의 패턴 및 스타일 파악 (import 방식, assertion 스타일, 헬퍼 함수 등)

### Step 3: 테스트 코드 생성/수정

#### 기존 테스트 파일이 있는 경우

- 기존 파일에 엣지케이스 테스트 케이스를 **추가**합니다
- 기존 테스트의 스타일/패턴을 따릅니다 (import, describe/it 구조, assertion 라이브러리 등)
- 기존 테스트와 중복되지 않도록 확인합니다

#### 기존 테스트 파일이 없는 경우

- 프로젝트의 테스트 컨벤션에 맞는 새 테스트 파일을 생성합니다
- 파일명은 프로젝트 패턴을 따릅니다 (예: `foo.test.ts`, `test_foo.py`)
- 필요한 import/setup을 포함합니다

#### 테스트 케이스 작성 원칙

- 각 엣지케이스마다 **별도 테스트 케이스**를 작성합니다
- 테스트명은 엣지케이스 시나리오를 명확히 설명합니다
- Arrange-Act-Assert (AAA) 패턴을 따릅니다
- 테스트가 독립적으로 실행 가능하도록 작성합니다

### Step 4: 테스트 실행

생성/수정한 테스트를 실행합니다:

- 프레임워크에 맞는 명령어를 사용합니다 (예: `npx jest`, `pytest`, `go test`)
- 가능하면 새로 추가한 테스트만 선택적으로 실행합니다
- 실행 결과를 캡처합니다

### Step 5: 결과 보고

아래 형식으로 결과를 출력합니다:

```
# 엣지케이스 테스트 결과

## 생성/수정된 테스트
| 파일 | 추가된 케이스 | 상태 |
|------|-------------|------|
| {파일경로} | {테스트명} | Pass / Fail |

## 실패한 테스트 상세
### {테스트명}
- **엣지케이스**: {설명}
- **기대 결과**: {expected}
- **실제 결과**: {actual}
- **수정 제안**: {코드 수정 방향}
```

실패한 테스트가 있는 경우:
- 실패 원인을 분석합니다
- 테스트 코드 문제인지, 실제 코드의 미처리 엣지케이스인지 구분합니다
- 실제 코드 수정이 필요한 경우 구체적 수정 방향을 제안합니다

모든 테스트가 통과한 경우:
- 엣지케이스가 이미 올바르게 처리되고 있음을 확인합니다

---

## 주의사항

- 기존 테스트를 삭제하거나 수정하지 않습니다 (추가만)
- 테스트 실행 시 기존 테스트가 깨지지 않는지 확인합니다
- mock/stub은 최소한으로 사용하고, 가능하면 실제 동작을 테스트합니다
- 프로젝트에 테스트 프레임워크가 설정되어 있지 않으면 사용자에게 알리고 프레임워크 선택을 요청합니다

---

## 사용 예시

```
/review:test-edge --from-analyze                    # analyze 결과의 엣지케이스로 테스트 생성
/review:test-edge 빈 배열 입력, null 값 처리          # 직접 엣지케이스 지정
/review:test-edge --from-analyze 추가로 타임아웃 케이스  # analyze 결과 + 추가 케이스
```
